const isEvent=e=>e.startsWith("on"),isProperty=e=>"children"!==e&&!isEvent(e),isNew=(e,t)=>o=>e[o]!==t[o];function updateDom(e,t,o){var n;Object.keys(t).filter(isEvent).filter((e=>!(e in o)||isNew(t,o)(e))).forEach((o=>{const n=o.toLowerCase().substring(2);e.removeEventListener(n,t[o])})),Object.keys(t).filter(isProperty).filter((n=o,e=>!(e in n))).forEach((t=>{e[t]=""})),Object.keys(o).filter(isProperty).filter(isNew(t,o)).forEach((t=>{e[t]=o[t]})),Object.keys(o).filter(isEvent).filter(isNew(t,o)).forEach((t=>{const n=t.toLowerCase().substring(2);e.addEventListener(n,o[t])}))}function commitWork(e){if(!e)return;let t=e.parent;for(;!t.dom;)t=t.parent;const o=t.dom;"PLACEMENT"===e.effectTag&&null!=e.dom?o.appendChild(e.dom):"UPDATE"===e.effectTag&&null!=e.dom?updateDom(e.dom,e.alternate.props,e.props):"DELETION"===e.effectTag&&commitDeletion(e,o),commitWork(e.child),commitWork(e.sibling)}function commitDeletion(e,t){e.dom?t.removeChild(e.dom):commitDeletion(e.child,t)}let e=null,t=null,o=null,n=null;function performUnitOfWork(e){if(e.type instanceof Function?function updateFunctionComponent(e){r=e,l=0,r.hooks=[];const t=[e.type(e.props)];reconcileChildren(e,t)}(e):function updateHostComponent(e){e.dom||(e.dom=function createDom(e){const t="TEXT_ELEMENT"==e.type?document.createTextNode(""):document.createElement(e.type);return updateDom(t,{},e.props),t}(e));reconcileChildren(e,e.props.children)}(e),e.child)return e.child;let t=e;for(;t;){if(t.sibling)return t.sibling;t=t.parent}}requestIdleCallback((function workLoop(r){let l=!1;for(;e&&!l;)e=performUnitOfWork(e),l=r.timeRemaining()<1;!e&&o&&function commitRoot(){n.forEach(commitWork),commitWork(o.child),t=o,o=null}(),requestIdleCallback(workLoop)}));let r=null,l=null;function useState(i){const c=r.alternate&&r.alternate.hooks&&r.alternate.hooks[l],a={state:c?c.state:i,queue:[]};(c?c.queue:[]).forEach((e=>{a.state=e(a.state)}));return r.hooks.push(a),l++,[a.state,r=>{a.queue.push(r),o={dom:t.dom,props:t.props,alternate:t},e=o,n=[]}]}function reconcileChildren(e,t){let o=0,r=e.alternate&&e.alternate.child,l=null;for(;o<t.length||null!=r;){const i=t[o];let c=null;const a=r&&i&&i.type==r.type;a&&(c={type:r.type,props:i.props,dom:r.dom,parent:e,alternate:r,effectTag:"UPDATE"}),i&&!a&&(c={type:i.type,props:i.props,dom:null,parent:e,alternate:null,effectTag:"PLACEMENT"}),r&&!a&&(r.effectTag="DELETION",n.push(r)),r&&(r=r.sibling),0===o?e.child=c:i&&(l.sibling=c),l=c,o++}}var i={createElement:function createElement(e,t={},...o){return{type:e,props:{...t,children:o.flat().map((e=>"object"==typeof e?e:function createTextElement(e){return{type:"TEXT_ELEMENT",props:{nodeValue:e,children:[]}}}(e)))}}},render:function render(r,l){o={dom:l,props:{children:[r]},alternate:t},n=[],e=o}};export default i;export{useState};
//# sourceMappingURL=index.mjs.map
